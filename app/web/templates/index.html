{% extends "base.html" %}

{% block content %}
  <section class="panel grid">
    <form class="import-form" method="post" action="/import.url">
      <label for="product_url">Product URL</label>
      <input
        id="product_url"
        name="product_url"
        type="url"
        placeholder="https://store.com/products/example"
        value="{{ form.product_url }}"
        required
      />

      <button type="submit">Import URL</button>
    </form>

    <aside class="info">
      <h2>Try URLs</h2>
      <ul>
        {% for example in examples %}
        <li><code>{{ example }}</code></li>
        {% endfor %}
      </ul>
      <p class="api-note">API endpoint: <code>POST /api/v1/import</code></p>
    </aside>
  </section>

  {% if preview_product_json %}
  <section class="panel">
    <h2>URL Import Preview</h2>
    <details class="preview-disclosure">
      <summary>Show Preview JSON</summary>
      <pre class="preview-json"><code>{{ preview_product_json }}</code></pre>
    </details>
  </section>

  <section class="panel grid">
    <form class="import-form" method="post" action="/export-from-product.csv">
      <input type="hidden" name="product_json_b64" value="{{ preview_product_json_b64 }}" />

      <label for="preview_target_platform">Target Platform</label>
      <div class="select-wrap">
        <select id="preview_target_platform" name="target_platform" required>
          <option value="shopify">Shopify</option>
          <option value="bigcommerce">BigCommerce</option>
          <option value="wix">Wix</option>
          <option value="squarespace">Squarespace</option>
          <option value="woocommerce">WooCommerce</option>
        </select>
      </div>

      <label for="preview_weight_unit">Weight Unit</label>
      <div class="select-wrap">
        <select id="preview_weight_unit" name="weight_unit" required></select>
      </div>

      <div id="preview-bigcommerce-fields" class="conditional-fields is-hidden" aria-hidden="true">
        <label for="preview_bigcommerce_csv_format">BigCommerce CSV Format</label>
        <div class="select-wrap">
          <select id="preview_bigcommerce_csv_format" name="bigcommerce_csv_format" disabled>
            <option value="modern">Modern</option>
            <option value="legacy">Legacy</option>
          </select>
        </div>
      </div>

      <div id="preview-squarespace-fields" class="conditional-fields is-hidden" aria-hidden="true">
        <label for="preview_squarespace_product_page">Squarespace Product Page</label>
        <input id="preview_squarespace_product_page" name="squarespace_product_page" type="text" placeholder="shop" disabled />
        <label for="preview_squarespace_product_url">Squarespace Product URL</label>
        <input id="preview_squarespace_product_url" name="squarespace_product_url" type="text" placeholder="lemons" disabled />
      </div>

      <button type="submit">Export Preview as CSV</button>
    </form>

    <aside class="info">
      <h2>Export</h2>
      <p class="api-note">API endpoint: <code>POST /api/v1/export/from-product.csv</code></p>
    </aside>
  </section>
  {% endif %}

  {% if error %}
  <section class="panel error">
    <h2>{{ error_title }}</h2>
    <p>{{ error }}</p>
  </section>
  {% endif %}
{% endblock %}
